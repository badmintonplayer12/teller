<!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Badminton Poengteller</title>
  <style>
    :root{
      /* fast luft for navn + litt margin */
      --top-reserve: 92px;
      /* horisontal innvendig luft p√• hver side, for √• hindre at siffer "touch" ytterkant */
      --side-padding: 3.2vw;
    }
    *{ box-sizing:border-box; -webkit-tap-highlight-color: transparent; }
    html,body{ height:100%; }
    body{ margin:0; font-family:system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; background:#0f172a; color:#fff; display:flex; flex-direction:column; max-width:100vw; overflow-x:hidden; }
    header{ background:#111827; padding:.5rem 1rem; display:flex; align-items:center; gap:1rem; justify-content:space-between; position:sticky; top:0; z-index:10 }
    header h1{ font-size:1rem; margin:0 }
    #version{ font-size:.75rem; color:#9ca3af }

    /* 2 kolonner + tynn midtlinje */
    .wrap{ flex:1; display:grid; grid-template-columns:1fr 2px 1fr; column-gap:2.5rem; padding:1rem; max-width:100vw; }
    .divider{ background:#1e293b; }

    /* Hver side minst en viewport-h√∏yde, s√• minus-knapp alltid krever scroll */
    .side{ position:relative; background:#0f172a; border-radius:.8rem; padding:1rem; min-height:100svh; display:flex; flex-direction:column; align-items:center; }

    .name{ height:64px; display:flex; align-items:center; justify-content:center; width:100%; margin:0 0 .5rem 0; }
    .name input{ font:inherit; color:#e5e7eb; background:#1f2937; border:1px solid #0008; border-radius:.5rem; padding:.35rem .75rem; text-align:center; width:min(22rem, 80%); }

    .setCounter{ position:absolute; top:.5rem; right:.75rem; background:#22c55e; color:#06210f; font-weight:900; border-radius:999px; padding:.2rem .6rem; min-width:2rem; text-align:center }

    /* Poengtallets st√∏rrelse styres 100% av CSS
       - h√∏yde: 100svh minus reservert topp
       - bredde: maks 33vw (halv skjerm minus kolonne-gap) og ogs√• dempet av padding
       - vmin tak for ekstremt kvadratiske skjermer */
    .score{ width:100%; display:flex; justify-content:center; align-items:center; text-align:center; font-weight:900; line-height:0.9; cursor:pointer; user-select:none; -webkit-user-select:none; white-space:nowrap; overflow:hidden; padding:0 var(--side-padding); font-variant-numeric:tabular-nums; font-size: clamp(64px, min(calc(33vw - var(--side-padding)), calc(100svh - var(--top-reserve))), 40vmin); }
    .digits{ display:flex; gap:0.08em; align-items:baseline; max-width:100%; overflow:hidden }
    .digit{ display:inline-block; width:1ch; text-align:center }
    .digit.ghost{ visibility:hidden }

    .scoreBox{ flex:1 1 auto; width:100%; min-height:0; display:flex; align-items:center; justify-content:center }

    /* Minus-knappen ligger alltid MINST en skjermh√∏yde ned */
    .minusWrap{ width:100%; display:flex; justify-content:center; align-items:center; margin-top: max(100svh, 28rem); }
    .minusBtn{ font-size:1.35rem; padding:.55rem 1rem; border-radius:.7rem; border:0; background:#ef4444; color:#fff; cursor:pointer; box-shadow:0 4px 18px #ef444466 }

    #sets{ padding:.6rem 1rem; text-align:center; font-size:1.2rem; opacity:.92 }
    #winnerMsg{ padding:1rem 1rem 0; text-align:center; font-size:clamp(1.2rem,3.5vw,2rem); color:#facc15; font-weight:900; white-space:pre-line }
  </style>
</head>
<body>
  <header>
    <h1>üè∏ Badminton Poengteller</h1>
    <button id="fsBtn" onclick="toggleFullscreen()">‚õ∂ Fullskjerm</button>
    <div id="version">v5.1-css</div>
  </header>

  <div id="sets">Sett: 0-0</div>

  <div class="wrap">
    <div class="side" id="sideA">
      <div id="setCounterA" class="setCounter" style="display:none">0</div>
      <div class="name"><input id="nameA" value="Spiller A" /></div>
      <div class="scoreBox">
        <div class="score" id="scoreA" onclick="addPoint('A')">
          <span class="digits">
            <span class="digit" id="A_tens">0</span>
            <span class="digit" id="A_ones">0</span>
          </span>
        </div>
      </div>
      <div class="minusWrap"><button class="minusBtn" onclick="removePoint('A')">‚àí1</button></div>
    </div>

    <div class="divider"></div>

    <div class="side" id="sideB">
      <div id="setCounterB" class="setCounter" style="display:none">0</div>
      <div class="name"><input id="nameB" value="Spiller B" /></div>
      <div class="scoreBox">
        <div class="score" id="scoreB" onclick="addPoint('B')">
          <span class="digits">
            <span class="digit" id="B_tens">0</span>
            <span class="digit" id="B_ones">0</span>
          </span>
        </div>
      </div>
      <div class="minusWrap"><button class="minusBtn" onclick="removePoint('B')">‚àí1</button></div>
    </div>
  </div>

  <div id="winnerMsg"></div>

  <footer>
    <button onclick="swapSides()">Bytt side</button>
    <button onclick="resetSet()">Nullstill sett</button>
    <button id="newMatchBtn" onclick="startNewMatch()">Start ny kamp</button>
    <button onclick="resetMatch()">Nullstill kamp</button>
  </footer>

  <script>
    // Minimal kamp-logikk ‚Äì kun funksjonelt, ingen layout-beregning
    let scoreA=0, scoreB=0; let setsA=0, setsB=0; const target=21, cap=30; let currentSet=1; let swappedAt11=false; let locked=false;

    function update(){
      document.getElementById('sets').textContent = `Sett: ${setsA}-${setsB}`;
      const A_t = Math.floor(scoreA/10), A_o=scoreA%10; const B_t=Math.floor(scoreB/10), B_o=scoreB%10;
      const AT=document.getElementById('A_tens'), AO=document.getElementById('A_ones');
      const BT=document.getElementById('B_tens'), BO=document.getElementById('B_ones');
      if(scoreA<10){ AT.textContent='0'; AT.classList.add('ghost'); } else { AT.textContent=String(A_t); AT.classList.remove('ghost'); }
      AO.textContent=String(A_o);
      if(scoreB<10){ BT.textContent='0'; BT.classList.add('ghost'); } else { BT.textContent=String(B_t); BT.classList.remove('ghost'); }
      BO.textContent=String(B_o);
      const counterA=document.getElementById('setCounterA'); const counterB=document.getElementById('setCounterB');
      counterA.style.display = setsA>0 ? 'flex' : 'none'; counterB.style.display = setsB>0 ? 'flex' : 'none';
      if(setsA>0) counterA.textContent=setsA; if(setsB>0) counterB.textContent=setsB;
    }

    function addPoint(side){ if(locked) return; if(side==='A') scoreA++; else scoreB++; checkSetEnd(); update(); }
    function removePoint(side){ if(locked) return; if(side==='A'&&scoreA>0) scoreA--; if(side==='B'&&scoreB>0) scoreB--; update(); }

    function checkSetEnd(){
      const lead=Math.abs(scoreA-scoreB);
      if((scoreA>=target||scoreB>=target)&&(lead>=2||scoreA===cap||scoreB===cap)){
        if(scoreA>scoreB) setsA++; else setsB++;
        if(setsA===2||setsB===2){
          const nameA=document.getElementById('nameA').value; const nameB=document.getElementById('nameB').value;
          const matchWinner=setsA===2?nameA:nameB; const matchLoser=setsA===2?nameB:nameA;
          document.getElementById('winnerMsg').textContent=`üéâ GRATULERER ${matchWinner.toUpperCase()}! DU VANT KAMPEN!\nüëè BRA JOBBA ${matchLoser.toUpperCase()}, DU GJORDE DITT BESTE.`;
          locked=true; return;
        }
        scoreA=0; scoreB=0; currentSet++; swappedAt11=false; swapSides();
      }
      if(currentSet===3 && !swappedAt11 && (scoreA===11||scoreB===11)){ swapSides(); swappedAt11=true; }
    }

    function swapSides(){
      const nameA=document.getElementById('nameA'); const nameB=document.getElementById('nameB');
      const tmpName=nameA.value; nameA.value=nameB.value; nameB.value=tmpName;
      const tmpScore=scoreA; scoreA=scoreB; scoreB=tmpScore; const tmpSets=setsA; setsA=setsB; setsB=tmpSets; update();
    }

    function resetSet(){ if(locked) return; scoreA=0; scoreB=0; swappedAt11=false; document.getElementById('winnerMsg').textContent=''; update(); }
    function resetMatch(){ scoreA=0; scoreB=0; setsA=0; setsB=0; currentSet=1; swappedAt11=false; locked=false; document.getElementById('winnerMsg').textContent=''; update(); }
    function startNewMatch(){ resetMatch(); }

    function toggleFullscreen(){ const btn=document.getElementById('fsBtn'); if(!document.fullscreenElement){ document.documentElement.requestFullscreen(); if(btn) btn.textContent='‚§¢ Avslutt fullskjerm'; } else { document.exitFullscreen(); if(btn) btn.textContent='‚õ∂ Fullskjerm'; } }

    update();
  </script>
</body>
</html>
